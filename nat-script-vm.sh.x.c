#if 0
	shc Version 3.8.9b, Generic Script Compiler
	Copyright (c) 1994-2015 Francisco Rosales <frosal@fi.upm.es>

	shc -f nat-script-vm.sh 
#endif

static  char data [] = 
#define      date_z	1
#define      date	((&data[0]))
	"\117"
#define      tst2_z	19
#define      tst2	((&data[3]))
	"\254\302\173\075\321\142\202\024\122\313\065\231\337\331\165\042"
	"\352\343\121\351\071\342"
#define      chk2_z	19
#define      chk2	((&data[27]))
	"\340\306\261\150\126\117\031\165\060\014\317\112\272\102\303\265"
	"\175\131\055\104\205\141\071\115\203"
#define      inlo_z	3
#define      inlo	((&data[48]))
	"\374\210\213"
#define      opts_z	1
#define      opts	((&data[51]))
	"\354"
#define      xecc_z	15
#define      xecc	((&data[54]))
	"\172\116\231\105\242\016\276\326\307\222\330\045\245\146\020\352"
	"\221\160"
#define      pswd_z	256
#define      pswd	((&data[99]))
	"\036\123\135\130\000\037\073\366\005\260\327\314\142\077\032\345"
	"\217\315\332\125\066\202\257\330\367\052\046\147\013\161\072\165"
	"\177\117\247\056\036\373\332\034\246\246\233\241\303\150\261\224"
	"\171\233\246\333\162\376\205\300\304\162\110\326\343\202\114\143"
	"\322\363\222\360\357\154\015\226\023\250\067\326\021\350\153\212"
	"\203\022\145\366\020\353\266\324\135\377\253\101\202\367\244\124"
	"\353\066\104\333\243\121\161\266\372\250\214\013\221\370\225\025"
	"\012\373\013\032\347\302\357\104\301\233\206\103\222\052\230\176"
	"\141\334\131\004\056\312\272\051\163\107\064\004\077\312\032\112"
	"\305\046\144\254\350\124\361\252\357\167\356\201\242\206\377\003"
	"\143\130\007\222\043\302\273\226\012\357\233\112\272\265\224\200"
	"\333\371\054\304\115\036\156\074\226\134\276\070\343\275\073\107"
	"\026\103\331\072\006\224\320\021\204\154\133\077\041\360\277\375"
	"\351\354\301\067\012\060\163\240\215\061\331\160\357\024\267\006"
	"\130\221\100\137\046\021\160\253\176\314\352\237\274\251\235\246"
	"\225\137\335\240\217\121\100\034\203\031\215\162\056\105\171\207"
	"\326\272\347\375\314\127\250\112\043\222\352\340\074\207\207\321"
	"\347\144\161\166\266\262\223\071\314\040\254\373\146\232\132\051"
	"\356\270\201\356\330\274\344\336\155\274\253\317\374\305\265\213"
	"\223\220\341\311\023\220\242\012\273\311\161\306\143\314\357\122"
	"\204\161\100\135\056\045\073\233\341\346\153\336\254\040\151\077"
	"\261\113\011\304\334\254\316\227\165\100"
#define      lsto_z	1
#define      lsto	((&data[416]))
	"\042"
#define      tst1_z	22
#define      tst1	((&data[418]))
	"\276\175\014\002\053\326\374\341\206\024\307\050\374\373\164\337"
	"\220\203\223\273\166\123\241\154\356\354"
#define      chk1_z	22
#define      chk1	((&data[443]))
	"\257\134\344\015\302\332\365\142\215\307\073\025\011\152\134\072"
	"\013\310\250\061\064\252\163\020\363"
#define      msg2_z	19
#define      msg2	((&data[471]))
	"\273\375\305\171\144\256\237\141\122\244\217\177\127\163\163\160"
	"\307\156\013\337\036\072"
#define      msg1_z	42
#define      msg1	((&data[490]))
	"\232\077\375\317\260\232\072\146\226\030\141\055\140\166\252\210"
	"\101\022\116\013\113\322\235\327\353\147\003\164\065\171\034\310"
	"\020\325\251\025\067\321\255\204\247\063\342\262\130\171\050"
#define      rlax_z	1
#define      rlax	((&data[537]))
	"\031"
#define      text_z	2578
#define      text	((&data[629]))
	"\065\342\231\043\317\052\115\127\236\136\113\360\033\137\253\030"
	"\045\261\037\256\224\322\006\016\372\236\345\374\103\011\051\170"
	"\354\302\234\273\355\352\023\213\110\136\173\144\276\046\175\343"
	"\330\234\221\155\157\230\173\151\067\141\145\172\153\216\363\130"
	"\120\220\024\076\172\047\311\303\206\105\050\104\153\245\047\104"
	"\102\271\262\261\121\056\033\211\217\200\003\206\111\232\046\134"
	"\251\123\251\240\011\323\354\055\302\204\015\306\247\371\201\350"
	"\064\367\147\005\014\162\351\170\060\272\027\175\020\161\150\064"
	"\360\173\050\312\273\377\160\245\237\271\026\114\312\133\206\025"
	"\207\171\210\125\321\065\067\360\002\175\140\217\153\144\325\354"
	"\355\013\242\044\123\216\073\014\277\353\142\062\040\003\340\206"
	"\366\167\131\363\245\110\076\060\153\023\062\020\072\326\273\343"
	"\035\115\152\064\355\231\100\152\000\222\007\304\257\351\117\273"
	"\316\117\342\265\011\267\202\115\127\344\365\117\260\117\257\125"
	"\175\055\336\251\347\151\222\062\350\167\323\206\167\152\106\345"
	"\361\103\064\271\272\327\377\171\347\314\171\025\000\131\021\030"
	"\367\303\350\247\076\061\027\225\304\232\372\153\116\136\234\135"
	"\040\372\270\344\033\272\320\113\107\226\373\312\355\313\104\043"
	"\346\320\004\321\240\342\263\331\311\206\123\304\347\245\306\071"
	"\264\174\071\365\264\324\230\006\217\160\145\252\303\255\115\211"
	"\062\200\010\236\141\356\231\011\342\012\230\263\043\337\343\225"
	"\247\176\056\133\357\144\137\325\137\164\152\025\235\224\010\122"
	"\077\032\356\174\122\063\320\154\024\050\302\217\067\336\266\226"
	"\224\063\017\141\374\247\156\024\225\113\103\110\312\055\121\005"
	"\113\271\001\312\042\156\314\174\037\107\151\176\101\053\205\102"
	"\377\100\025\276\257\152\157\165\026\376\327\262\103\042\061\305"
	"\302\145\371\302\003\012\375\322\201\076\360\127\047\305\251\351"
	"\107\354\115\043\315\105\246\234\217\105\070\114\352\275\172\360"
	"\314\131\346\107\204\045\171\360\375\345\060\012\250\157\177\342"
	"\264\372\274\171\177\345\267\207\060\375\107\267\333\114\131\362"
	"\143\227\025\042\122\030\203\271\151\032\011\323\033\222\151\010"
	"\166\253\303\123\113\331\175\056\040\040\166\141\172\157\263\302"
	"\252\322\300\303\020\352\310\031\064\124\147\036\314\137\222\352"
	"\321\162\110\000\130\247\174\374\055\377\047\235\312\265\275\114"
	"\274\253\241\133\271\271\132\340\053\023\006\202\271\000\002\266"
	"\046\364\042\071\316\242\256\234\275\262\300\162\267\176\121\213"
	"\164\352\130\036\116\001\220\250\041\055\026\345\305\074\103\324"
	"\216\063\054\200\030\277\232\352\111\356\131\335\206\302\165\051"
	"\347\112\070\020\064\276\264\315\227\161\306\105\166\375\015\007"
	"\300\357\056\133\052\113\077\274\362\357\160\210\150\032\004\353"
	"\207\274\236\361\371\254\303\305\330\116\315\321\106\017\225\064"
	"\330\041\153\335\125\265\030\156\132\322\217\154\327\022\206\126"
	"\302\106\221\321\344\251\115\173\110\114\334\206\344\274\123\155"
	"\110\353\370\006\030\345\312\213\210\125\232\125\352\157\050\260"
	"\252\056\167\214\160\106\223\304\170\062\261\075\124\060\241\252"
	"\263\017\034\111\251\333\336\125\264\353\171\352\056\171\316\166"
	"\356\215\354\217\071\110\107\061\066\336\313\232\024\000\013\164"
	"\250\321\251\304\037\311\210\204\210\132\215\371\263\001\024\311"
	"\372\242\106\144\373\104\026\026\216\363\321\023\223\071\030\053"
	"\273\177\011\362\001\001\263\036\013\232\237\051\221\301\340\131"
	"\322\135\262\163\013\345\044\327\324\310\237\301\241\250\372\013"
	"\153\214\040\374\032\302\046\027\017\066\331\065\240\222\373\026"
	"\113\136\177\371\130\377\013\225\004\311\166\072\233\260\166\316"
	"\100\217\160\366\137\104\261\357\302\030\132\156\071\143\363\337"
	"\275\213\167\321\342\365\074\322\331\077\104\101\267\200\201\247"
	"\256\343\135\236\176\072\050\351\132\053\363\064\315\015\173\307"
	"\305\020\030\225\353\150\373\353\302\375\027\042\336\357\272\342"
	"\055\360\334\077\076\272\163\015\230\110\241\142\354\124\152\356"
	"\323\157\340\224\210\173\167\011\230\367\036\353\052\261\230\072"
	"\011\144\031\047\375\115\020\146\111\272\263\017\036\321\021\263"
	"\111\265\045\151\166\042\177\322\246\203\342\136\164\333\170\256"
	"\176\005\315\126\206\063\311\311\076\210\203\165\077\252\233\257"
	"\310\325\063\266\232\155\203\305\020\133\232\202\363\014\013\010"
	"\135\315\021\114\206\302\005\027\131\273\012\134\046\151\350\037"
	"\303\014\235\154\057\044\120\324\337\101\273\060\211\217\025\071"
	"\025\216\316\234\064\367\313\373\052\114\165\113\031\343\137\271"
	"\027\213\265\352\052\371\140\213\014\125\043\006\227\105\311\201"
	"\060\066\113\275\312\302\146\357\255\110\273\301\037\172\075\236"
	"\151\102\141\157\210\322\044\372\173\366\254\361\113\354\342\373"
	"\315\125\216\342\320\054\201\075\102\345\325\346\322\105\062\071"
	"\047\203\007\325\253\312\057\124\147\112\336\050\022\366\375\035"
	"\267\171\271\134\276\275\005\225\112\221\331\153\276\146\341\133"
	"\152\342\061\302\343\066\033\312\210\356\365\023\256\352\323\272"
	"\262\004\130\273\201\110\111\256\273\071\301\312\120\106\303\071"
	"\271\135\335\273\020\137\342\325\235\242\166\324\267\026\140\016"
	"\116\217\132\100\305\104\125\071\245\315\301\341\113\267\007\270"
	"\066\012\315\170\030\257\036\034\111\123\054\025\217\240\015\010"
	"\063\165\240\001\326\172\251\354\363\031\262\110\026\005\157\052"
	"\200\277\236\333\124\177\127\037\164\040\344\361\204\262\210\350"
	"\050\275\140\362\341\153\215\201\031\203\012\214\056\065\301\006"
	"\205\215\051\136\161\375\356\322\116\161\131\006\167\002\140\207"
	"\311\277\321\317\177\374\376\364\201\032\011\070\164\244\064\303"
	"\300\303\345\366\366\324\213\010\237\173\124\054\127\125\015\340"
	"\345\146\355\356\207\257\176\105\275\312\136\075\030\017\245\013"
	"\254\120\254\200\377\311\176\327\151\226\176\327\171\063\170\040"
	"\310\372\067\214\015\111\166\077\300\043\375\022\034\160\334\306"
	"\225\156\307\131\320\147\247\106\105\000\214\012\263\235\067\231"
	"\050\251\175\361\271\234\077\135\217\300\251\024\151\276\157\114"
	"\166\124\304\320\117\040\076\357\263\266\105\172\237\326\021\076"
	"\314\175\343\257\321\273\075\275\037\236\230\361\137\153\213\204"
	"\147\151\236\057\000\152\016\273\000\320\267\257\234\333\040\333"
	"\022\064\001\201\245\056\221\202\356\141\020\040\061\360\022\376"
	"\125\034\350\021\273\213\141\020\336\243\301\116\342\330\144\202"
	"\224\005\151\322\356\153\325\307\155\040\257\072\364\074\342\076"
	"\153\014\336\370\126\372\241\130\226\154\014\005\102\363\200\145"
	"\302\302\175\025\240\245\057\043\047\174\160\264\022\306\320\042"
	"\344\130\240\220\224\206\130\015\146\050\160\016\257\210\277\165"
	"\312\147\150\133\205\367\376\351\052\137\371\203\374\102\345\246"
	"\044\230\015\370\063\234\305\216\060\146\042\212\220\144\354\331"
	"\145\206\276\336\056\125\175\136\213\016\274\354\125\343\252\024"
	"\105\033\337\030\004\125\246\340\204\177\172\035\034\144\112\371"
	"\270\121\060\277\134\065\241\034\223\202\115\356\203\060\000\303"
	"\101\277\126\201\022\123\357\122\231\165\113\317\050\174\025\272"
	"\176\326\323\223\274\045\042\266\361\133\320\313\352\237\335\217"
	"\022\232\332\041\227\355\021\245\060\122\135\240\375\224\020\264"
	"\242\006\322\005\236\262\061\177\164\030\342\303\200\253\044\064"
	"\313\017\071\300\060\171\325\152\145\371\030\326\150\056\105\164"
	"\347\050\231\121\102\342\223\211\265\060\042\177\350\013\173\126"
	"\051\172\343\323\355\205\037\204\375\142\046\120\221\077\342\347"
	"\025\005\043\247\242\331\035\277\236\311\151\345\341\112\062\352"
	"\272\132\164\133\116\064\212\206\171\221\226\173\024\004\267\202"
	"\243\273\124\003\200\100\345\010\151\277\031\100\312\316\074\032"
	"\372\302\131\026\026\371\233\314\226\102\022\026\116\354\365\033"
	"\024\267\216\237\213\010\375\227\024\111\050\350\025\065\371\300"
	"\107\376\037\317\321\332\132\054\242\362\232\253\353\351\336\224"
	"\213\330\151\025\330\173\226\370\332\361\241\116\017\055\334\047"
	"\124\022\007\352\342\045\067\205\112\061\150\362\264\100\374\375"
	"\212\163\024\247\222\300\060\175\201\170\176\175\020\056\274\017"
	"\211\142\164\006\364\330\004\212\163\320\177\105\317\112\202\220"
	"\320\330\014\160\362\203\213\044\213\375\377\214\247\364\364\321"
	"\134\271\256\170\372\023\005\136\331\307\362\206\164\304\236\003"
	"\026\200\265\142\244\302\117\302\350\256\033\027\325\214\056\237"
	"\220\044\033\171\135\322\056\021\172\170\353\315\242\134\346\251"
	"\206\207\220\226\140\045\246\127\303\250\316\053\304\222\336\067"
	"\222\330\045\221\142\120\031\012\071\352\303\363\065\222\174\117"
	"\235\010\342\034\064\211\247\112\340\244\016\224\110\313\013\365"
	"\175\205\266\027\212\220\274\060\337\257\137\055\026\170\052\302"
	"\232\165\057\043\214\172\240\304\064\155\302\136\272\317\151\120"
	"\162\175\347\350\214\077\106\014\225\240\305\166\212\115\127\002"
	"\260\262\374\307\347\367\225\267\077\244\243\367\057\366\256\162"
	"\316\144\141\330\125\373\262\260\161\041\054\005\035\051\231\243"
	"\244\350\074\302\330\205\147\076\122\203\301\273\334\234\152\326"
	"\066\153\223\312\075\040\121\372\132\172\216\061\364\107\073\230"
	"\276\365\373\334\145\027\114\034\002\014\364\364\362\343\241\022"
	"\350\047\143\252\126\164\057\053\223\301\235\134\131\346\304\025"
	"\105\134\145\321\357\352\064\216\370\111\352\174\233\217\350\073"
	"\372\352\037\141\153\000\275\311\376\302\205\007\171\205\357\147"
	"\352\246\101\125\030\061\207\255\163\242\003\366\242\042\017\150"
	"\307\302\340\366\312\245\301\062\120\077\277\044\254\215\346\366"
	"\117\021\032\006\156\121\137\172\310\224\164\027\331\264\264\251"
	"\033\163\144\011\353\167\315\246\114\335\306\343\076\030\103\145"
	"\005\265\025\340\360\303\333\022\346\176\074\370\047\257\040\332"
	"\024\126\336\053\164\270\343\312\017\014\156\013\255\034\220\203"
	"\125\032\240\212\275\212\065\357\033\217\230\106\237\244\211\273"
	"\370\200\235\273\147\005\127\316\202\301\366\064\037\050\174\031"
	"\061\131\274\271\055\121\142\063\016\267\372\334\357\137\247\066"
	"\112\346\245\220\234\014\333\101\075\105\066\367\273\173\351\052"
	"\246\156\345\245\363\064\024\367\007\304\201\042\310\232\150\366"
	"\127\046\077\074\332\122\360\245\004\316\150\265\273\164\032\102"
	"\104\327\245\121\076\274\111\242\155\252\354\012\372\366\061\360"
	"\324\115\112\336\037\214\124\051\201\350\255\001\352\126\052\114"
	"\203\061\152\344\240\266\355\214\052\035\072\272\117\100\216\110"
	"\223\271\033\053\140\231\020\174\132\245\311\063\133\055\075\376"
	"\347\375\161\043\071\077\377\273\066\255\076\135\202\044\202\137"
	"\257\210\213\154\021\014\317\207\245\227\277\116\123\327\050\005"
	"\217\167\331\174\045\200\143\033\126\023\222\353\274\320\057\046"
	"\134\017\356\066\154\311\176\234\006\264\147\155\333\251\037\100"
	"\262\012\312\164\272\367\341\166\206\336\123\370\307\112\260\120"
	"\215\201\054\147\172\211\001\334\044\102\026\371\076\370\264\337"
	"\373\152\306\027\121\326\341\277\212\260\205\272\134\014\316\050"
	"\175\223\062\327\015\032\120\061\115\170\254\331\204\363\333\201"
	"\041\261\271\144\377\124\063\344\350\252\323\327\275\203\243\022"
	"\056\231\337\137\350\330\075\232\300\256\014\304\127\203\163\342"
	"\212\172\367\327\236\375\141\347\346\174\254\274\206\226\315\024"
	"\326\031\174\100\310\347\305\246\067\053\222\361\143\105\122\046"
	"\350\027\374\242\357\060\277\074\336\150\164\360\146\042\027\003"
	"\034\255\333\144\035\127\133\050\311\362\161\346\242\373\017\367"
	"\123\140\207\147\236\002\217\147\306\025\255\356\131\031\224\200"
	"\135\326\072\020\210\213\076\243\025\316\044\030\311\063\020\035"
	"\223\227\204\062\232\023\232\140\050\107\116\202\140\343\003\276"
	"\272\075\316\102\311\015\345\336\333\011\367\245\075\007\302\321"
	"\237\106\003\071\132\235\231\203\345\350\005\105\313\010\003\205"
	"\105\322\310\017\337\256\355\273\267\344\140\364\354\042\306\213"
	"\151\311\304\303\147\136\106\114\107\113\221\023\124\225"
#define      shll_z	10
#define      shll	((&data[3321]))
	"\141\206\042\361\377\103\014\304\104\157\362\251"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !defined(TRACEABLE)

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !defined(TRACEABLE) */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !defined(TRACEABLE)
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
